<Window x:Class="Tests.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:Tests"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        Title="Test Viewer"
        Background="#FF42474B"
        Foreground="#FFC8CDD1"
        DataContext="{Binding RelativeSource={RelativeSource Self}}">
    <Window.Resources>
        <CollectionViewSource x:Key="TestCollectionViewSource"
                              Source="{Binding TestCollection}">
            <CollectionViewSource.SortDescriptions>
                <scm:SortDescription  PropertyName="Category" />
                <scm:SortDescription PropertyName="Name" />
            </CollectionViewSource.SortDescriptions>
            <CollectionViewSource.GroupDescriptions>
                <PropertyGroupDescription  PropertyName="Category" />
            </CollectionViewSource.GroupDescriptions>
        </CollectionViewSource>
    </Window.Resources>
    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="1*" />
            <ColumnDefinition Width="2*" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>
        <ListBox Name="list"
                 Background="#FF2F3437"
                 BorderThickness="0"
                 SelectionMode="Single"
                 SelectionChanged="list_SelectionChanged"
                 ItemsSource="{Binding Source={StaticResource TestCollectionViewSource}}">
            <ListBox.GroupStyle>
                <GroupStyle>
                    <GroupStyle.ContainerStyle>
                        <Style TargetType="{x:Type GroupItem}">
                            <Setter Property="Template">
                                <Setter.Value>
                                    <ControlTemplate>
                                        <Expander Header="{Binding Name}"
                                                  Foreground="#FFDDDDDD"
                                                  Padding="10,4"
                                                  FontWeight="SemiBold"
                                                  FontSize="16"
                                                  IsExpanded="False">
                                            <Expander.Template>
                                                <ControlTemplate TargetType="{x:Type Expander}">
                                                    <Border BorderBrush="{TemplateBinding BorderBrush}"
                                                            BorderThickness="{TemplateBinding BorderThickness}"
                                                            Background="{TemplateBinding Background}"
                                                            CornerRadius="3"
                                                            SnapsToDevicePixels="True">
                                                        <DockPanel>
                                                            <ToggleButton x:Name="HeaderSite"
                                                                          ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                                          Content="{TemplateBinding Header}"
                                                                          DockPanel.Dock="Top"
                                                                          Foreground="{TemplateBinding Foreground}"
                                                                          FontWeight="{TemplateBinding FontWeight}"
                                                                          FontStyle="{TemplateBinding FontStyle}"
                                                                          FontStretch="{TemplateBinding FontStretch}"
                                                                          FontSize="{TemplateBinding FontSize}"
                                                                          FontFamily="{TemplateBinding FontFamily}"
                                                                          HorizontalContentAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                          IsChecked="{Binding IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                                          Margin="1"
                                                                          MinWidth="0"
                                                                          MinHeight="0"
                                                                          Padding="{TemplateBinding Padding}"
                                                                          VerticalContentAlignment="{TemplateBinding VerticalContentAlignment}">
                                                                <ToggleButton.FocusVisualStyle>
                                                                    <Style>
                                                                        <Setter Property="Control.Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate>
                                                                                    <Border>
                                                                                        <Rectangle Margin="0"
                                                                                                   SnapsToDevicePixels="True"
                                                                                                   Stroke="Black"
                                                                                                   StrokeThickness="1"
                                                                                                   StrokeDashArray="1 2" />
                                                                                    </Border>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </ToggleButton.FocusVisualStyle>
                                                                <ToggleButton.Style>
                                                                    <Style TargetType="{x:Type ToggleButton}">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="{x:Type ToggleButton}">
                                                                                    <Border Padding="{TemplateBinding Padding}">
                                                                                        <Grid Background="Transparent"
                                                                                              SnapsToDevicePixels="False">
                                                                                            <Grid.ColumnDefinitions>
                                                                                                <ColumnDefinition Width="19" />
                                                                                                <ColumnDefinition Width="*" />
                                                                                            </Grid.ColumnDefinitions>
                                                                                            <Path x:Name="arrow"
                                                                                                  Data="M1,1.5L4.5,5 8,1.5"
                                                                                                  HorizontalAlignment="Center"
                                                                                                  SnapsToDevicePixels="False"
                                                                                                  Stroke="#FFDDDDDD"
                                                                                                  StrokeThickness="2"
                                                                                                  VerticalAlignment="Center" />
                                                                                            <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}"
                                                                                                              Content="{TemplateBinding Content}"
                                                                                                              Grid.Column="1"
                                                                                                              Margin="7,0,0,0"
                                                                                                              ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                                                                                              HorizontalAlignment="Left"
                                                                                                              RecognizesAccessKey="True"
                                                                                                              SnapsToDevicePixels="True"
                                                                                                              VerticalAlignment="Center" />
                                                                                        </Grid>
                                                                                    </Border>
                                                                                    <ControlTemplate.Triggers>
                                                                                        <Trigger Property="IsChecked"
                                                                                                 Value="True">
                                                                                            <Setter Property="Data"
                                                                                                    TargetName="arrow"
                                                                                                    Value="M1,4.5L4.5,1 8,4.5" />
                                                                                        </Trigger>
                                                                                        <Trigger Property="IsMouseOver"
                                                                                                 Value="True">
                                                                                            <Setter Property="Stroke"
                                                                                                    TargetName="arrow"
                                                                                                    Value="White" />
                                                                                        </Trigger>
                                                                                    </ControlTemplate.Triggers>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </ToggleButton.Style>
                                                            </ToggleButton>
                                                            <ContentPresenter x:Name="ExpandSite"
                                                                              ContentTemplate="{TemplateBinding ContentTemplate}"
                                                                              Content="{TemplateBinding Content}"
                                                                              ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                                                              DockPanel.Dock="Bottom"
                                                                              Focusable="False"
                                                                              HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                              Margin="{TemplateBinding Padding}"
                                                                              Visibility="Collapsed"
                                                                              VerticalAlignment="{TemplateBinding VerticalContentAlignment}" />
                                                        </DockPanel>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsExpanded"
                                                                 Value="True">
                                                            <Setter Property="Visibility"
                                                                    TargetName="ExpandSite"
                                                                    Value="Visible" />
                                                        </Trigger>
                                                        <Trigger Property="ExpandDirection"
                                                                 Value="Right">
                                                            <Setter Property="DockPanel.Dock"
                                                                    TargetName="ExpandSite"
                                                                    Value="Right" />
                                                            <Setter Property="DockPanel.Dock"
                                                                    TargetName="HeaderSite"
                                                                    Value="Left" />
                                                            <Setter Property="Style"
                                                                    TargetName="HeaderSite">
                                                                <Setter.Value>
                                                                    <Style TargetType="{x:Type ToggleButton}">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="{x:Type ToggleButton}">
                                                                                    <Border Padding="{TemplateBinding Padding}">
                                                                                        <Grid Background="Transparent"
                                                                                              SnapsToDevicePixels="False">
                                                                                            <Grid.RowDefinitions>
                                                                                                <RowDefinition Height="19" />
                                                                                                <RowDefinition Height="*" />
                                                                                            </Grid.RowDefinitions>
                                                                                            <Grid>
                                                                                                <Grid.LayoutTransform>
                                                                                                    <TransformGroup>
                                                                                                        <RotateTransform Angle="-90" />
                                                                                                    </TransformGroup>
                                                                                                </Grid.LayoutTransform>
                                                                                                <Path x:Name="arrow"
                                                                                                      Data="M1,1.5L4.5,5 8,1.5"
                                                                                                      HorizontalAlignment="Center"
                                                                                                      SnapsToDevicePixels="False"
                                                                                                      Stroke="#FFDDDDDD"
                                                                                                      StrokeThickness="2"
                                                                                                      VerticalAlignment="Center" />
                                                                                            </Grid>
                                                                                            <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}"
                                                                                                              Content="{TemplateBinding Content}"
                                                                                                              ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                                                                                              HorizontalAlignment="Center"
                                                                                                              Grid.Row="1"
                                                                                                              Margin="7,0,0,0"
                                                                                                              RecognizesAccessKey="True"
                                                                                                              SnapsToDevicePixels="True"
                                                                                                              VerticalAlignment="Top" />
                                                                                        </Grid>
                                                                                    </Border>
                                                                                    <ControlTemplate.Triggers>
                                                                                        <Trigger Property="IsChecked"
                                                                                                 Value="True">
                                                                                            <Setter Property="Data"
                                                                                                    TargetName="arrow"
                                                                                                    Value="M1,4.5L4.5,1 8,4.5" />
                                                                                        </Trigger>
                                                                                        <Trigger Property="IsMouseOver"
                                                                                                 Value="True">
                                                                                            <Setter Property="Stroke"
                                                                                                    TargetName="arrow"
                                                                                                    Value="White" />
                                                                                        </Trigger>
                                                                                    </ControlTemplate.Triggers>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                        <Trigger Property="ExpandDirection"
                                                                 Value="Up">
                                                            <Setter Property="DockPanel.Dock"
                                                                    TargetName="ExpandSite"
                                                                    Value="Top" />
                                                            <Setter Property="DockPanel.Dock"
                                                                    TargetName="HeaderSite"
                                                                    Value="Bottom" />
                                                            <Setter Property="Style"
                                                                    TargetName="HeaderSite">
                                                                <Setter.Value>
                                                                    <Style TargetType="{x:Type ToggleButton}">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="{x:Type ToggleButton}">
                                                                                    <Border Padding="{TemplateBinding Padding}">
                                                                                        <Grid Background="Transparent"
                                                                                              SnapsToDevicePixels="False">
                                                                                            <Grid.ColumnDefinitions>
                                                                                                <ColumnDefinition Width="19" />
                                                                                                <ColumnDefinition Width="*" />
                                                                                            </Grid.ColumnDefinitions>
                                                                                            <Grid>
                                                                                                <Grid.LayoutTransform>
                                                                                                    <TransformGroup>
                                                                                                        <RotateTransform Angle="180" />
                                                                                                    </TransformGroup>
                                                                                                </Grid.LayoutTransform>
                                                                                                <Path x:Name="arrow"
                                                                                                      Data="M1,1.5L4.5,5 8,1.5"
                                                                                                      HorizontalAlignment="Center"
                                                                                                      SnapsToDevicePixels="False"
                                                                                                      Stroke="#FF333333"
                                                                                                      StrokeThickness="2"
                                                                                                      VerticalAlignment="Center" />
                                                                                            </Grid>
                                                                                            <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}"
                                                                                                              Content="{TemplateBinding Content}"
                                                                                                              Grid.Column="1"
                                                                                                              ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                                                                                              HorizontalAlignment="Left"
                                                                                                              Margin="7,0,0,0"
                                                                                                              RecognizesAccessKey="True"
                                                                                                              SnapsToDevicePixels="True"
                                                                                                              VerticalAlignment="Center" />
                                                                                        </Grid>
                                                                                    </Border>
                                                                                    <ControlTemplate.Triggers>
                                                                                        <Trigger Property="IsChecked"
                                                                                                 Value="True">
                                                                                            <Setter Property="Data"
                                                                                                    TargetName="arrow"
                                                                                                    Value="M1,4.5L4.5,1 8,4.5" />
                                                                                        </Trigger>
                                                                                        <Trigger Property="IsMouseOver"
                                                                                                 Value="True">
                                                                                            <Setter Property="Stroke"
                                                                                                    TargetName="arrow"
                                                                                                    Value="White" />
                                                                                        </Trigger>
                                                                                    </ControlTemplate.Triggers>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                        <Trigger Property="ExpandDirection"
                                                                 Value="Left">
                                                            <Setter Property="DockPanel.Dock"
                                                                    TargetName="ExpandSite"
                                                                    Value="Left" />
                                                            <Setter Property="DockPanel.Dock"
                                                                    TargetName="HeaderSite"
                                                                    Value="Right" />
                                                            <Setter Property="Style"
                                                                    TargetName="HeaderSite">
                                                                <Setter.Value>
                                                                    <Style TargetType="{x:Type ToggleButton}">
                                                                        <Setter Property="Template">
                                                                            <Setter.Value>
                                                                                <ControlTemplate TargetType="{x:Type ToggleButton}">
                                                                                    <Border Padding="{TemplateBinding Padding}">
                                                                                        <Grid Background="Transparent"
                                                                                              SnapsToDevicePixels="False">
                                                                                            <Grid.RowDefinitions>
                                                                                                <RowDefinition Height="19" />
                                                                                                <RowDefinition Height="*" />
                                                                                            </Grid.RowDefinitions>
                                                                                            <Grid>
                                                                                                <Grid.LayoutTransform>
                                                                                                    <TransformGroup>
                                                                                                        <RotateTransform Angle="90" />
                                                                                                    </TransformGroup>
                                                                                                </Grid.LayoutTransform>
                                                                                                <Path x:Name="arrow"
                                                                                                      Data="M1,1.5L4.5,5 8,1.5"
                                                                                                      HorizontalAlignment="Center"
                                                                                                      SnapsToDevicePixels="False"
                                                                                                      Stroke="#FFDDDDDD"
                                                                                                      StrokeThickness="2"
                                                                                                      VerticalAlignment="Center" />
                                                                                            </Grid>
                                                                                            <ContentPresenter ContentTemplate="{TemplateBinding ContentTemplate}"
                                                                                                              Content="{TemplateBinding Content}"
                                                                                                              ContentStringFormat="{TemplateBinding ContentStringFormat}"
                                                                                                              HorizontalAlignment="Center"
                                                                                                              Margin="0,7,0,0"
                                                                                                              Grid.Row="1"
                                                                                                              RecognizesAccessKey="True"
                                                                                                              SnapsToDevicePixels="True"
                                                                                                              VerticalAlignment="Top" />
                                                                                        </Grid>
                                                                                    </Border>
                                                                                    <ControlTemplate.Triggers>
                                                                                        <Trigger Property="IsChecked"
                                                                                                 Value="True">
                                                                                            <Setter Property="Data"
                                                                                                    TargetName="arrow"
                                                                                                    Value="M1,4.5L4.5,1 8,4.5" />
                                                                                        </Trigger>
                                                                                        <Trigger Property="IsMouseOver"
                                                                                                 Value="True">
                                                                                            <Setter Property="Stroke"
                                                                                                    TargetName="arrow"
                                                                                                    Value="White" />
                                                                                        </Trigger>
                                                                                    </ControlTemplate.Triggers>
                                                                                </ControlTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </Style>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Trigger>
                                                        <Trigger Property="IsEnabled"
                                                                 Value="False">
                                                            <Setter Property="Foreground"
                                                                    Value="{DynamicResource {x:Static SystemColors.GrayTextBrushKey}}" />
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Expander.Template>
                                            <ItemsPresenter />
                                        </Expander>
                                    </ControlTemplate>
                                </Setter.Value>
                            </Setter>
                        </Style>
                    </GroupStyle.ContainerStyle>
                </GroupStyle>
            </ListBox.GroupStyle>
            <ListBox.ItemTemplate>
                <DataTemplate DataType="{x:Type local:Test}">
                    <Grid>
                        <TextBlock Foreground="#FFDDDDDD"
                                   Margin="42,4"
                                   FontWeight="SemiBold"
                                   FontSize="16"
                                   Text="{Binding Name}" />
                    </Grid>
                </DataTemplate>
            </ListBox.ItemTemplate>
        </ListBox>
        <ScrollViewer Name="resultItemsScrollViewer"
                      Grid.Column="1"
                      Visibility="Collapsed">
            <ItemsControl Name="resultItems"
                          Padding="50"
                          FontSize="18"     
                          FontFamily="Consolas"
                          Background="#FF42474B"
                          Foreground="#FFDDDDDD" />
        </ScrollViewer>
        <ScrollViewer Grid.Column="1"
                      Name="resultBoxScrollViewer"
                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                      ScrollViewer.HorizontalScrollBarVisibility="Auto">
            <TextBlock Name="resultBox"
                       Padding="50"
                       FontSize="18"
                       FontFamily="Consolas"
                       Background="#FF42474B"
                       Foreground="#FFDDDDDD" />
        </ScrollViewer>
        <ProgressBar Minimum="0"
                     Grid.Row="1"
                     Grid.ColumnSpan="2"
                     Visibility="Collapsed"
                     Height="35"
                     Maximum="100"
                     Name="progress" />
    </Grid>
</Window>